#!/usr/bin/env ruby
# frozen_string_literal: true

############################################################################################################
## Requires                                                                                               ##
############################################################################################################

require('bundler')

Dir.chdir(File.expand_path('../..', __FILE__))
Bundler.setup(:default, :development)

require('darkroom')
require('minitest')
require('minitest/mock')

############################################################################################################
## Monkey Patch Minitest                                                                                  ##
############################################################################################################

class Minitest::Result
  def location
    super.sub(/^\w+#/, '')
  end
end

############################################################################################################
## Run                                                                                                    ##
############################################################################################################

Dir[File.expand_path('test/**/*_test.rb')].each do |file|
  require(file)
end

ENV['MT_NO_PLUGINS'] = 'true'
Minitest.autorun
